#!/bin/bash

# Imaginary interpreter

lang="$1"
test -n "$lang" || exit 1
shift

echo Imaginary Interpreter for "$lang"
echo

user_prompt="Input: "

lang_lc="$(printf -- "%s" "$lang" | tr '[:upper:]' '[:lower:]')"
set -x

fun="$(penl | grep -P "imagine-a-${lang_lc}-interpreter/2")"

memory=

prompt_the_lm() {
    user_input="$1"

    if test -n "$fun"; then
        penf -p -u "$fun" "$memory" "$user_input"
    else
        penf -p -u pf-generic-interpreter/3 "$memory" "$user_input" "$lang"
    fi
}

prompt_the_lm
prompt_the_lm "5 + 5"
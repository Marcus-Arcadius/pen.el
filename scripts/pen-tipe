#!/bin/bash
export TTY

vipe_cmd="$1"
# eipe
: "${vipe_cmd:="vipe"}"

# echo start | pen-tv &>/dev/null

# This is hanging for pen-eipe when emacs is started with run.sh
# Therefore, pen-eipe is simply not finishing.
# Well, actually pen-eipe *does* finish.

if pen-tm session-exists human; then
    pen-tm -sout -vipe spv -t human: "$vipe_cmd" | cat
else
    pen-tm -sout -vipe spv "$vipe_cmd" | cat
fi

# pen-tm -w -sout -vipe spv "$vipe_cmd" | cat

# echo end | pen-tv &>/dev/null

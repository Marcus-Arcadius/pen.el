#!/bin/sh

# Example of usage:
# lm-complete translate-to.prompt French Goodnight
# or:
# echo French | lm-complete translate-to.prompt Goodnight

# This file expects the PEN_PROMPTS_DIR

# Update caches (would override LM_CACHE)
export UPDATE

# Request the pretty printer if the prompt specifies one
export DO_PRETTY_PRINT

# TODO Implement this function.
# LM_CACHE (Request to cache completions, that should happen here)
# pen.el has indicated this should be cached/memoised.
# ci (cache it)
ci() {
    if test "$LM_CACHE" = "y"; then
        "$@"
    else
        "$@"
    fi
}

prompt_file_path="$1"
test -z "$prompt_file_path" || {
    echo Could not find "$prompt_file_path" in 
    exit 1
}

stdin_exists() {
    ! [ -t 0 ] && ! test "$(readlink /proc/$$/fd/0)" = /dev/null
}

# TODO Handle other backend completers here
ci openai-complete.sh "$@"